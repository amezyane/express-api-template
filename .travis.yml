language: node_js
env:
  global:
  - CC_TEST_REPORTER_ID=6030befee5f13dfb8d2769115cff9f0681ac1fe334eebde74b48be926ff95d1e
matrix:
  include:
  - node_js: '12'
cache:
  directories:
  - node_modules
install: yarn --ignore-engines
after_success: yarn coverage
before_script:
- psql -c 'create database testdb;' -U postgres
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64
  > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- "./cc-test-reporter before-build"
script:
- yarn test
after_script:
- "./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT"
services:
- postgresql
addons:
  postgresql: '10'
  apt:
    packages:
    - postgresql-10
    - postgresql-client-10
before_install:
- sudo cp /etc/postgresql/{9.6,10}/main/pg_hba.conf
- sudo /etc/init.d/postgresql restart
deploy:
  provider: heroku
  app:
    master: express-ame
  api_key:
    secure: '09DSXarnhO0lhC3sQRl2On3Z5dAxd7CUBEBb6qdMQWc9X/IEuxf6KvZs9qCsk1QGSMejiyKWDus8O1ajSOjEeLpmciXOyv8cDF5/G698+9q2e3V1VFG9pKi+q4ybGdOQLqxJoT/j4+RJzinok/MGCk0/e2i51HE5L8H2ClgaiP1uudFJ0X7CCS3mL+slfTPbMalqFVlTu7w3/CpZNXqQuYjD6aQ1DnMgi+aVvcCBhOOMMP5xu4GMhwrb0zSYrh0Hs8TN/ZBTuMjcHTsHj5wgBMXbmuoN/LWvtfZNPgpm5WCweoy6wlEiMVGSFRZsqt77Qr8YRHn8MBPBBevVlm/8YyYjZFMizR6KLGfxfOoMF0rEk8EndRdbLu/HeGlFPqJ9pqpefv14BWMXP6nrD6p24zGCFxIaM4HZpeRu/488NTv8NX77bZ1ub3MxGD/TLg1VN3RsITF7jFN049Ch0C62Ob9CEDgLmEg2v2HWe5m6yYFTqUzCqZ3kGb0yvTcKpBtyXLs2uwwoS2gVRAAG9LLFLVcXqshJyTLBFrlixLQwmGFxYd+xu0atTNdXe3f+c6DrdcGuZ0W2FmC430QUiawvkX0n/j8HWhQr9qj8xnSINsw/Cj21IE4EO6xV1qNJfAolUDsch6s7LXG53C9GfKGBbx5D+0aEI+rKjw8hkp9foCk='
